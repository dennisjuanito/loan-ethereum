{"version":3,"file":"static/webpack/static/development/pages/loans/show.js.447583196739f5b6f160.hot-update.js","sources":["webpack:///./pages/loans/show.js"],"sourcesContent":["import React, {Component} from 'react';\nimport {Table, Card, Grid, CardContent} from 'semantic-ui-react';\nimport Layout from '../../components/Layout';\nimport RePaymentRow from '../../components/RepaymentsRow';\nimport Loan from '../../utils/loan';\nimport {Router} from '../../routes';\n\nexport default class Show extends Component {\n    state = {\n        rePayments: [],\n        loanTitle: '',\n        lenderAddress: '',\n        borrowerAddress: '',\n        loanContractAddress: '',\n        loadings: []\n    };\n    static async getInitialProps(props) {\n        const loanContractAddress = props.query.address;\n        const loan = await Loan(loanContractAddress);\n        const rePaymentsCount = await loan.methods.getRepaymentsCount().call();\n        const loanTitle = await loan.methods.loanTitle().call();\n        let lenderAddress = await loan.methods.lender().call();\n        let borrowerAddress = await loan.methods.borrower().call();\n        const rePayments = await Promise.all(\n            Array(parseInt(rePaymentsCount))\n                .fill()\n                .map((element, index) => {\n                    return loan.methods.rePayments(index).call();\n                })\n        );\n\n        return {rePayments, loanTitle, lenderAddress, borrowerAddress, loanContractAddress};\n    }\n\n    componentDidMount = async () => {\n        await this.setState({\n            rePayments: this.props.rePayments,\n            loanTitle: this.props.loanTitle,\n            lenderAddress: this.props.lenderAddress,\n            borrowerAddress: this.props.borrowerAddress,\n            loanContractAddress: this.props.loanContractAddress,\n            loadings: Array(this.props.rePayments.length).fill(false)\n        });\n        debugger;\n        console.log(this.state);\n    };\n\n    renderRows = () => {\n        debugger;\n        return this.state.rePayments.map((rePayment, index) => {\n            return (\n                <RePaymentRow\n                    key={index}\n                    month={index}\n                    loanContractAddress={this.state.loanContractAddress}\n                    loading={this.state.loading[index]}\n                    handleLoadingChange={this.handleLoadingChange}\n                    handleMonthToIsPaidChange={this.handleMonthToIsPaidChange}\n                    {...rePayment}\n                />\n            );\n        });\n    };\n\n    handleLoadingChange = async (val, idx) => {\n        const newLoadingsArr = [...this.state.loadings];\n        newLoadingsArr[idx] = val;\n        await this.setState({\n            loadings: newLoadingsArr\n        });\n    };\n\n    handleMonthToIsPaidChange = async () => {\n        console.log(this.props.rePayments);\n        debugger;\n        await Router.pushRoute(`/loans/${this.state.loanContractAddress}`);\n        console.log(this.props.rePayments);\n        await this.setState({\n            rePayments: this.props.rePayments\n        });\n    };\n\n    render() {\n        const {Header, Row, HeaderCell, Body} = Table;\n        return (\n            <Layout>\n                <Card fluid>\n                    <Card.Content textAlign='center'>\n                        <Card.Header>{this.state.loanTitle}</Card.Header>\n                        <Card.Meta>{this.state.loanContractAddress}</Card.Meta>\n                        <Card.Description>Lender: {this.state.lenderAddress}</Card.Description>\n                        <Card.Description>Borrower: {this.state.borrowerAddress}</Card.Description>\n                    </Card.Content>\n                </Card>\n                <Table celled>\n                    <Header>\n                        <Row>\n                            <HeaderCell>Month</HeaderCell>\n                            <HeaderCell>Date</HeaderCell>\n                            <HeaderCell>Balance</HeaderCell>\n                            <HeaderCell>Payment</HeaderCell>\n                            <HeaderCell>Interest</HeaderCell>\n                            <HeaderCell>Principal</HeaderCell>\n                            <HeaderCell>Status</HeaderCell>\n                            <HeaderCell />\n                        </Row>\n                    </Header>\n                    <Body>{this.renderRows()}</Body>\n                </Table>\n            </Layout>\n        );\n    }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;;;;;AAyBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AAFA;AASA;AACA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAYA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AAUA;AACA;AACA;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAIA;AADA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;AAOA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AACA;AADA;AAIA;AAJA;AAAA;AAMA;AADA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AASA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AACA;AAAA;AAOA;AAAA;AAiBA;;;;;;AA/FA;;;;;;AACA;;AACA;AACA;;AADA;;AACA;AACA;;AADA;;AACA;AACA;;AADA;;AACA;AACA;;AADA;;AACA;AACA;;AADA;;AACA;AAIA;AACA;AACA;;AANA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;AAzBA;AACA;;;;;A","sourceRoot":""}